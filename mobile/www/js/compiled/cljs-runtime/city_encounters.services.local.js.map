{"version":3,"sources":["city_encounters/services/local.cljs"],"mappings":";;AAIA,6CAAA,7CAAKA;AAEL,mDAAA,nDAAMC;AAAN,AACE,OAAUC,yDAAYF;;AAExB,6CAAA,7CAAMG,kGAAaC;AAAnB,AACE,oBAAIA;AACF,OAAO,AAACH,wDACN,WAAKI;AAAL,AACE,IAAMC,eAAa,kHAAA,2EAAA,7LAACC,0DAAQF;AAA5B,AACE,OAAO,AAAUH,yDAAYF,2CAAY,AAACQ,qBAAQ,AAACC,6CAAKH,aAAaF,kBACnE,WAAKM;AAAL,AACC,uBAAA,mFAAA,1GAACC,sLAAoCP;;AACrC,aAAA,NAACQ;;;;AACV,aAAA,NAACA;;;AAEL,+CAAA,/CAAMC,sGAAeC;AAArB,AACE,OAAO,AAACb,wDACN,WAAKI;AAAL,AACE,IAAMC,eAAa,kHAAA,2EAAA,7LAACC,0DAAQF;IACtBU,SAAO,+CAAA,WAAAC,1DAACC;AAAD,AAAS,OAACC,6CAAE,AAAA,iFAAAF,kBAASF;GAAIR;AADtC,AAEE,OAAO,AAAUJ,yDAAYF,2CAAY,AAACQ,qBAAQO,cAChD,WAAKL;AAAL,AACC,uBAAA,mFAAA,1GAACC,4LAAuCI;;AACxC,aAAA,NAACH","names":["city-encounters.services.local/STORAGE_KEY","city-encounters.services.local/get-current-state","js/module$node_modules$localforage$dist$localforage","city-encounters.services.local/handle-save","encounter","value","currentValue","cljs.core.js__GT_clj","cljs.core/clj->js","cljs.core.conj","_","re-frame.core/dispatch","js/alert","city-encounters.services.local/handle-delete","id","newVal","p1__29154#","cljs.core.remove","cljs.core._EQ_"],"sourcesContent":["(ns city-encounters.services.local\n  (:require [\"localforage\" :as localforage]\n            [re-frame.core :as re-frame]))\n\n(def STORAGE_KEY \"mgg-city-encoutners-ids\")\n\n(defn get-current-state []\n  (.getItem localforage STORAGE_KEY))\n\n(defn handle-save [encounter]\n  (if encounter\n    (.then (get-current-state)\n      (fn [value]\n        (let [currentValue (js->clj value :keywordize-keys true)]\n          (.then (.setItem localforage STORAGE_KEY (clj->js (conj currentValue encounter)))\n            (fn [_]\n             (re-frame/dispatch [:set-new-outcome encounter])\n             (js/alert \"Saved!\"))))))\n    (js/alert \"No Encounter To Save!\")))\n\n(defn handle-delete [id]\n  (.then (get-current-state)\n    (fn [value]\n      (let [currentValue (js->clj value :keywordize-keys true)\n            newVal (remove #(= (:_id %) id) currentValue)]\n        (.then (.setItem localforage STORAGE_KEY (clj->js newVal))\n          (fn [_]\n           (re-frame/dispatch [:set-saved-outcomes newVal])\n           (js/alert \"Deleted!\")))))))\n"]}